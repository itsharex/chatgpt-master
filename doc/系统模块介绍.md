 # ChatMASTER 系统模块介绍

> ChatMASTER模块说明

| 模块              | 备注  | 
|----------------- |---------------- |
| chat-master-admin   | 管理端代码 （Vue2）         |
| chat-master-server    | 后端服务代码（Java） | 
| chat-master-uniapp    | 移动端Uniapp代码，支持App、小程序、H5    |
| chat-master-web    | Web端代码（Vue3）    |

## chat-master-server

## chat-master-admin

## chat-master-web

### Node

`node` 需要 `^14 || ^16 || ^18 || ^19` 版本（`node >= 14` 需要安装 [fetch polyfill](https://github.com/developit/unfetch#usage-as-a-polyfill)），使用 [nvm](https://github.com/nvm-sh/nvm) 可管理本地多个 `node` 版本 

> node14版本建议14.20版本以上，若使用admin管理后台，可以选择安装node14版本，即运行两端项目时候无需切换node版本。

```shell
node -v
```

### PNPM（16^版本安装）

如果你没有安装过 `pnpm`
```shell
npm install pnpm -g
```
## 安装依赖

### 前端
根目录下运行以下命令
```shell
# 安装pnpm时
pnpm bootstrap
# 命令二选一
# 没安装pnpm时，即node选择14版本
npm i
```

## 测试环境运行

### 前端网页
根目录下运行以下命令
```shell
# 安装pnpm时
pnpm dev
# 命令二选一
# 没安装pnpm时，即node选择14版本
npm run dev
```

#### 防止爬虫抓取

**nginx**

将下面配置填入nginx配置文件中，可以参考 `docker-compose/nginx/nginx.conf` 文件中添加反爬虫的方法

```
    # 防止爬虫抓取
    if ($http_user_agent ~* "360Spider|JikeSpider|Spider|spider|bot|Bot|2345Explorer|curl|wget|webZIP|qihoobot|Baiduspider|Googlebot|Googlebot-Mobile|Googlebot-Image|Mediapartners-Google|Adsbot-Google|Feedfetcher-Google|Yahoo! Slurp|Yahoo! Slurp China|YoudaoBot|Sosospider|Sogou spider|Sogou web spider|MSNBot|ia_archiver|Tomato Bot|NSPlayer|bingbot")
    {
      return 403;
    }
```

### 手动打包

#### 前端网页

1、修改根目录下 `.env` 文件中的 `VITE_GLOB_API_URL` 为你的实际后端接口地址

2、根目录下运行以下命令，然后将 `dist` 文件夹内的文件复制到你网站服务的根目录下

[参考信息](https://cn.vitejs.dev/guide/static-deploy.html#building-the-app)

```shell
pnpm build
```

## 常见问题
Q: 为什么 `Git` 提交总是报错？

A: 因为有提交信息验证，请遵循 [Commit 指南](./CONTRIBUTING.md)

Q: 如果只使用前端页面，在哪里改请求接口？

A: 根目录下 `.env` 文件中的 `VITE_GLOB_API_URL` 字段。

Q: 文件保存时全部爆红?

A: `vscode` 请安装项目推荐插件，或手动安装 `Eslint` 插件。

Q: 前端没有打字机效果？

A: 一种可能原因是经过 Nginx 反向代理，开启了 buffer，则 Nginx 会尝试从后端缓冲一定大小的数据再发送给浏览器。请尝试在反代参数后添加 `proxy_buffering off;`，然后重载 Nginx。其他 web server 配置同理。

## chat-master-h5